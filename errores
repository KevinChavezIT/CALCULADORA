# ============================================
# VERSION SIMPLE - Solo ejecutar y listo
# ============================================

$excelPath = "C:\nmon-Vios\nmon analyser v69_2 2.xlsm"

Write-Host "Ejecutando NMON Analyzer..." -ForegroundColor Yellow

try {
    # Ejecutar sin complicaciones
    $excel = New-Object -ComObject Excel.Application
    $excel.Visible = $true
    $workbook = $excel.Workbooks.Open($excelPath)
    
    # Esperar a que cargue
    Start-Sleep -Seconds 15
    
    # Ejecutar macro y IGNORAR CUALQUIER ERROR
    $excel.Run("Button2_Click") | Out-Null
    
    Write-Host "Macro ejecutada. NMON está procesando..." -ForegroundColor Green
    Write-Host "Puedes cerrar Excel manualmente cuando termine." -ForegroundColor Yellow
    
    # No cerrar automáticamente
    Write-Host ""
    Write-Host "Presiona Enter para salir del script (Excel seguirá abierto)..." -ForegroundColor Gray
    Read-Host
    
} catch {
    # Ignorar todos los errores
    Write-Host "Script ejecutado (ignorando errores técnicos)" -ForegroundColor Green
}