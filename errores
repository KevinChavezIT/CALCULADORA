---
- name: Obtener LUNs desde Active IQ Unified Manager
  hosts: localhost
  gather_facts: true
  vars:
    info_dir: "C:\\info_luns"
    csv_file: "luns_NetApp.csv"
    temp_csv_path: "C:\\info_luns\\luns_NetApp.csv"

  tasks:

  pre_tasks:
    - name: Log start of playbook execution
      ansible.builtin.include_role:
        name: pichincha.sre.pre_task

    - name: Consultar todas las LUNs
      ansible.builtin.uri:
        url: https://10.70.89.21/api/datacenter/storage/luns
        method: GET
        user: "{{ LOGIN_USER }}"
        password: "{{ LOGIN_PASS }}"
        force_basic_auth: true
        validate_certs: false
        return_content: true
        headers:
          Accept: "application/json"
      register: luns_response
